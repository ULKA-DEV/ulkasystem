<div id="news-section" class="overview-banner mb-4">
    <small class="opacity-75 fw-bold">üì¢ ‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</small>
    <h3 class="fw-bold mb-0">‡πÄ‡∏õ‡πâ‡∏≤‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå: ‡∏ø 2,500,000</h3>
    <p class="small mb-0 mt-2">* ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="main-sales">‡∏ø 1,984,469.24</span></p>
</div>

<div class="widget-switch" id="control-panel">
    <div class="sw-item active" onclick="showHome()"><i class="fas fa-home"></i> ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</div>
    
    <div class="sw-item d-none" id="btn-exec" onclick="loadPage('exec_warroom.html', 'btn-exec')">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£</div>
    <div class="sw-item d-none" id="btn-mkt" onclick="loadPage('mkt_planner.html', 'btn-mkt')">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î</div>
    <div class="sw-item d-none" id="btn-csr" onclick="loadPage('csr_system.html', 'btn-csr')">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</div>
    <div class="sw-item d-none" id="btn-acc" onclick="loadPage('acc_hr.html', 'btn-acc')">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</div>
    <div class="sw-item d-none" id="btn-tech" onclick="loadPage('tech_work.html', 'btn-tech')">‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á</div>
</div>

<script>
    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å LocalStorage (‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ Login)
    const user = JSON.parse(localStorage.getItem('user_session')) || { dept: 'guest', role: 'none' };

    function checkAccess() {
        const dept = user.dept;
        const role = user.role;

        // 1. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠ Admin ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏£‡∏ö
        if (role === 'admin' || dept.includes('‡∏õ‡∏£‡∏∞‡∏ò‡∏≤‡∏ô')) {
            document.querySelectorAll('.sw-item').forEach(el => el.classList.remove('d-none'));
        } 
        // 2. ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£ + ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
        else {
            if (dept === '‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î') document.getElementById('btn-mkt').classList.remove('d-none');
            if (dept === '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢') document.getElementById('btn-csr').classList.remove('d-none');
            if (dept === '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•') document.getElementById('btn-acc').classList.remove('d-none');
            if (dept === '‡πÅ‡∏ú‡∏ô‡∏Å‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏≤‡∏á') document.getElementById('btn-tech').classList.remove('d-none');
        }
    }

    function loadPage(fileName, btnId) {
        // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£
        document.getElementById('news-section').style.display = 'none';
        // ‡πÄ‡∏õ‡∏¥‡∏î Iframe
        const container = document.getElementById('widget-container');
        const iframe = document.getElementById('main-iframe');
        
        container.style.display = 'block';
        iframe.src = fileName;

        // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°
        document.querySelectorAll('.sw-item').forEach(el => el.classList.remove('active'));
        document.getElementById(btnId).classList.add('active');
    }

    function showHome() {
        document.getElementById('news-section').style.display = 'block';
        document.getElementById('widget-container').style.display = 'none';
        document.querySelectorAll('.sw-item').forEach(el => el.classList.remove('active'));
    }

    // ‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    checkAccess();
</script>
